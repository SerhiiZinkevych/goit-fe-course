{"version":3,"sources":["webpack:///./templates/galleryItemTemplate.hbs","webpack:///./index.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","propertyIsEnumerable","helper","alias2","nullContext","alias3","hooks","helperMissing","alias4","alias5","escapeExpression","webformatURL","call","tags","largeImageURL","likes","views","comments","downloads","refs","gallery","document","querySelector","formBtn","formField","end","masonryInstance","Masonry","itemSelector","columnWidth","percentPosition","gutter","transitionDuration","visibleStyle","transform","opacity","hiddenStyle","InfiniteScroll","imagesLoaded","ImagesLoaded","infScrollInstance","responseType","history","outlayer","status","path","value","this","pageIndex","proxyElem","createElement","infLoadHandler","response","hits","JSON","parse","length","markup","map","galleryItemTemplate","join","innerHTML","items","querySelectorAll","appendItems","appended","body","clientHeight","window","innerHeight","loadNextPage","handleResponse","loadCount","PNotify","error","text","off","style","display","addEventListener","e","preventDefault","on","remove","getItemElements","gridSizer","classList","add","appendChild","layout","target","tagName","basicLightbox","dataset","source","show","fetch","then","r","json","d","stringify","catch","console","log"],"mappings":"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","file":"main.4b305311b8e38fa94eb1.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=container.propertyIsEnumerable, alias2=depth0 != null ? depth0 : (container.nullContext || {}), alias3=container.hooks.helperMissing, alias4=\"function\", alias5=container.escapeExpression;\n\n  return \"  <li class=\\\"grid-item\\\">\\n    <div class=\\\"photo-card\\\">\\n      <img src=\\\"\"\n    + alias5(((helper = (helper = helpers.webformatURL || (depth0 != null ? depth0.webformatURL : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias5(((helper = (helper = helpers.tags || (depth0 != null ? depth0.tags : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"tags\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" data-source=\\\"\"\n    + alias5(((helper = (helper = helpers.largeImageURL || (depth0 != null ? depth0.largeImageURL : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" />\\n      <div class=\\\"stats\\\">\\n        <p class=\\\"stats-item\\\">\\n          <i class=\\\"material-icons\\\">thumb_up</i>\\n          \"\n    + alias5(((helper = (helper = helpers.likes || (depth0 != null ? depth0.likes : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"likes\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n          <i class=\\\"material-icons\\\">visibility</i>\\n          \"\n    + alias5(((helper = (helper = helpers.views || (depth0 != null ? depth0.views : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"views\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n          <i class=\\\"material-icons\\\">comment</i>\\n          \"\n    + alias5(((helper = (helper = helpers.comments || (depth0 != null ? depth0.comments : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"comments\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n          <i class=\\\"material-icons\\\">cloud_download</i>\\n          \"\n    + alias5(((helper = (helper = helpers.downloads || (depth0 != null ? depth0.downloads : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"downloads\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\n        </p>\\n      </div>\\n    </div>\\n  </li>\";\n},\"useData\":true});","import 'material-design-icons/iconfont/material-icons.css';\nimport './styles.css';\nimport 'basiclightbox/dist/basicLightbox.min.css';\nimport 'pnotify/dist/PnotifyBrightTheme.css';\n\nimport Masonry from 'masonry-layout';\nimport ImagesLoaded from 'imagesloaded';\nimport InfiniteScroll from 'infinite-scroll';\nimport * as basicLightbox from 'basiclightbox';\nimport PNotify from 'pnotify/dist/es/PNotify';\n\nimport galleryItemTemplate from './templates/galleryItemTemplate.hbs';\n\n// к-во картинок за одну загрузку\nconst picsPerPage = 12;\n\n//использую cors anywhere потому что получаю CORS от pixabay даже когда заливаю на github\n//const corsAnyWhere = 'https://cors-anywhere.herokuapp.com/';\nconst baseUrl =\n  //corsAnyWhere +\n  'https://pixabay.com/api/?key=14481243-ffa5b678be0edea71dcb3ff43';\n\nconst refs = {\n  gallery: document.querySelector('#gallery'),\n  formBtn: document.querySelector('.search-btn'),\n  formField: document.querySelector('.search-field'),\n  end: document.querySelector('.infinite-scroll-last'),\n};\n\nconst masonryInstance = new Masonry(refs.gallery, {\n  itemSelector: '.grid-item',\n  columnWidth: '.grid-sizer',\n  percentPosition: true,\n  gutter: 10,\n  transitionDuration: '0.3s',\n  visibleStyle: { transform: 'translateY(0)', opacity: 1 },\n  hiddenStyle: { transform: 'translateY(100px)', opacity: 0 },\n});\n\n// Указываем InfiniteScroll ссылку на imagesLoaded\nInfiniteScroll.imagesLoaded = ImagesLoaded;\n\nconst infScrollInstance = new InfiniteScroll('.grid', {\n  responseType: 'text',\n  history: false,\n  outlayer: masonryInstance, //указываем InfiniteScroll ссылку на Masonry\n  status: '.page-load-status', // анимация загрузки\n\n  path: function() {\n    return (\n      baseUrl +\n      `&q=${refs.formField.value}&per_page=${picsPerPage}&page=${this.pageIndex}`\n    );\n  },\n});\n\n// proxy элемент для создания объектов HTML из разметки\nconst proxyElem = document.createElement('div');\n\nfunction handleResponse(hits) {\n  const markup = hits.map(galleryItemTemplate).join();\n  proxyElem.innerHTML = markup;\n  const items = proxyElem.querySelectorAll('.grid-item');\n  ImagesLoaded(items, function() {\n    infScrollInstance.appendItems(items);\n    masonryInstance.appended(items);\n    // Если загруженного контента не хватает для появления скролла - делаем еще один запрос пока не заполним экран.\n    // Иначе не сработает Infinite scroll для подальшей загрузки изображений.\n    if (document.body.clientHeight < window.innerHeight) {\n      infScrollInstance.loadNextPage();\n    }\n  });\n}\n\nfunction infLoadHandler(response) {\n  //достаем обьекты из ответа\n  const { hits } = JSON.parse(response);\n  if (hits.length > 0) {\n    handleResponse(hits);\n  } else {\n    //если пришло 0 записей и это первая загрузка показываем сообщение о том что картинок нет\n    if (infScrollInstance.loadCount === 1) {\n      PNotify.error({\n        text: 'No images found! 😢',\n      });\n    } else {\n      //если это не первая загрузка отвязываем событие по загрузке данных и отображаем параграф \"End of content\"\n      //так как pixabay возвращает пустой массив даже есликартинок не найдено...\n      //или если, например, на странице pageIndex - №100 картинок не найдено...\n      //можно запрашивать страницу 101,102,103 и pixabay всегда будет возвращать пустой массив\n      //и infinite Scroll не перестает отправять запросы.\n      //По этому чуть погуглив нашел вариант отвязывать событие если картинки закончились и привязывать при первом запросе.\n      infScrollInstance.off('load', infLoadHandler);\n      refs.end.style.display = 'block';\n    }\n  }\n}\n\nrefs.formBtn.addEventListener('click', e => {\n  e.preventDefault();\n  //Сброс параметров при первом запросе.\n  refs.end.style.display = 'none';\n  infScrollInstance.pageIndex = 1;\n  infScrollInstance.loadCount = 0;\n  //привязка infScrollInstance\n  infScrollInstance.on('load', infLoadHandler);\n  //Чистим Masonry\n  masonryInstance.remove(masonryInstance.getItemElements());\n  //Чистим DOM\n  refs.gallery.innerHTML = '';\n  //Добавляем grid-sizer в сетку\n  const gridSizer = document.createElement('li');\n  gridSizer.classList.add('grid-sizer');\n  refs.gallery.appendChild(gridSizer);\n  //загружаем порцию элементов и размещаем их\n  infScrollInstance.loadNextPage();\n  masonryInstance.layout();\n});\n\nrefs.gallery.addEventListener('click', e => {\n  // если кликнули по картинке basicLightBox покажет большую картинку которая хранится в аттрибуте \"data-source\"\n  if (e.target.tagName === 'IMG') {\n    basicLightbox.create(`<img src=\"${e.target.dataset.source}\">`).show();\n  }\n});\n\nconst word = 'dog';\nconst URL = `https://pixabay.com/api/?key=14481243-ffa5b678be0edea71dcb3ff43&q=${word}&per_page=${picsPerPage}&page=${1}`;\n\nfetch(URL)\n  .then(r => r.json())\n  .then(d => {\n    refs.gallery.innerHTML = JSON.stringify(d, null, 4);\n  })\n  .catch(console.log);\n"],"sourceRoot":""}